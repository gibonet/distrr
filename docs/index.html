<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Estimate and Manage Empirical Distributions • distrr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Estimate and Manage Empirical Distributions">
<meta name="description" content="Tools to estimate and manage empirical distributions, which should work with survey data. One of the main features is the possibility to create data cubes of estimated statistics, that include all the combinations of the variables of interest (see for example functions dcc5() and dcc6()).">
<meta property="og:description" content="Tools to estimate and manage empirical distributions, which should work with survey data. One of the main features is the possibility to create data cubes of estimated statistics, that include all the combinations of the variables of interest (see for example functions dcc5() and dcc6()).">
<meta property="og:image" content="https://gibonet.github.io/distrr/logo.svg">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">distrr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.6.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/gibonet/distrr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9">
<div class="section level1">
<div class="page-header">
<img src="logo.svg" class="logo" alt=""><h1 id="distrr-">distrr 
<a class="anchor" aria-label="anchor" href="#distrr-"></a>
</h1>
</div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>distrr provides some tools to estimate and manage empirical distributions. In particular, one of the main features of distrr is the creation of data cubes of estimated statistics, that include all the combinations of the variables of interest. The package makes strong usage of the tools provided by <a href="https://cran.r-project.org/package=dplyr" class="external-link">dplyr</a>, which is a grammar of data manipulation.</p>
<p>The main functions to create a data cube are <code><a href="reference/dcc.html">dcc5()</a></code> and <code><a href="reference/dcc6.html">dcc6()</a></code> (<code>dcc</code> stands for data cube creation).</p>
<p>The data cube creation is like:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>data <span class="sc">|&gt;</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>  <span class="fu">group_by</span>(some variables) <span class="sc">|&gt;</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">summarise</span>(one or more estimated statistic)</span></code></pre></div>
<p>in <a href="https://cran.r-project.org/package=dplyr" class="external-link">dplyr</a> terms, but the operation is done for each possible combination of the variables used for grouping. The result will be a data frame in “tidy form”. See some examples in the Usage section below.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># From CRAN</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">"distrr"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a><span class="co"># Or the development version from GitHub:</span></span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a><span class="co"># install.packages("remotes")</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>remotes<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">"gibonet/distrr"</span>)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>Consider the <code>invented_wages</code> dataset:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://gibonet.github.io/distrr">distrr</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">invented_wages</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [1,000 × 5] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ gender        : Factor w/ 2 levels "men","women": 1 2 1 2 1 1 1 2 2 2 ...</span></span>
<span><span class="co">#&gt;  $ sector        : Factor w/ 2 levels "secondary","tertiary": 2 1 2 2 1 1 2 1 2 1 ...</span></span>
<span><span class="co">#&gt;  $ education     : Factor w/ 3 levels "I","II","III": 3 2 2 2 2 1 3 1 2 2 ...</span></span>
<span><span class="co">#&gt;  $ wage          : num [1:1000] 8400 4200 5100 7400 4300 4900 5400 2900 4500 3000 ...</span></span>
<span><span class="co">#&gt;  $ sample_weights: num [1:1000] 105 32 36 12 21 46 79 113 34 32 ...</span></span></code></pre></div>
<p>If we want to count the number of observations and estimate the average wage by gender, with <a href="https://cran.r-project.org/package=dplyr" class="external-link">dplyr</a> we can do:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="va">invented_wages</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">gender</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, av_wage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 2 × 3</span></span>
<span><span class="co">#&gt;   gender     n av_wage</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;  &lt;int&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 men      547   5435.</span></span>
<span><span class="co">#&gt; 2 women    453   4441.</span></span></code></pre></div>
<p>We can estimate the same statistics but grouped by education by changing the argument inside <code>group_by</code>:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">invented_wages</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">education</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, av_wage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 3 × 3</span></span>
<span><span class="co">#&gt;   education     n av_wage</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 I           172   3774.</span></span>
<span><span class="co">#&gt; 2 II          719   5099.</span></span>
<span><span class="co">#&gt; 3 III         109   6139.</span></span></code></pre></div>
<p>and estimate the statistics by gender and education including both variables in <code>group_by</code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">invented_wages</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">gender</span>, <span class="va">education</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>, av_wage <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; `summarise()` has grouped output by 'gender'. You can override using the</span></span>
<span><span class="co">#&gt; `.groups` argument.</span></span>
<span><span class="co">#&gt; # A tibble: 6 × 4</span></span>
<span><span class="co">#&gt;   gender education     n av_wage</span></span>
<span><span class="co">#&gt;   &lt;fct&gt;  &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 men    I            60   4627.</span></span>
<span><span class="co">#&gt; 2 men    II          409   5278.</span></span>
<span><span class="co">#&gt; 3 men    III          78   6886.</span></span>
<span><span class="co">#&gt; 4 women  I           112   3317.</span></span>
<span><span class="co">#&gt; 5 women  II          310   4865.</span></span>
<span><span class="co">#&gt; 6 women  III          31   4261.</span></span></code></pre></div>
<p>With <code>dcc5</code> we can perform all the steps above with one call:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">invented_wages</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/dcc.html">dcc5</a></span><span class="op">(</span>.variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"education"</span><span class="op">)</span>, av_wage <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; # A tibble: 12 × 4</span></span>
<span><span class="co">#&gt;    gender education     n av_wage</span></span>
<span><span class="co">#&gt;  * &lt;fct&gt;  &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 Totale Totale     1000   4985.</span></span>
<span><span class="co">#&gt;  2 Totale I           172   3774.</span></span>
<span><span class="co">#&gt;  3 Totale II          719   5099.</span></span>
<span><span class="co">#&gt;  4 Totale III         109   6139.</span></span>
<span><span class="co">#&gt;  5 men    Totale      547   5435.</span></span>
<span><span class="co">#&gt;  6 men    I            60   4627.</span></span>
<span><span class="co">#&gt;  7 men    II          409   5278.</span></span>
<span><span class="co">#&gt;  8 men    III          78   6886.</span></span>
<span><span class="co">#&gt;  9 women  Totale      453   4441.</span></span>
<span><span class="co">#&gt; 10 women  I           112   3317.</span></span>
<span><span class="co">#&gt; 11 women  II          310   4865.</span></span>
<span><span class="co">#&gt; 12 women  III          31   4261.</span></span></code></pre></div>
<p>The resulting data frame contains a column for each grouping variable, and the estimations of all the combinations of the variables:</p>
<ul>
<li>by gender</li>
<li>by education</li>
<li>by gender and education</li>
<li>plus the same statistics for all the dataset, without any grouping (this can be set with the argument <code>.all</code>, which by default is <code>TRUE</code>).</li>
</ul>
<p>Note that in the result there are some rows where the variables take the value <code>"Totale"</code>. When a variable has this value, it means that the subset of the data considered in that row contains all the values of the variable. For example, the first row of the result of <code>dcc5</code> contains the estimations for all the dataset. The value <code>"Totale"</code> can be changed with the argument <code>.total</code>.</p>
<p>The same result of <code>dcc5</code> can be produced by <code>dcc6</code>, with a slightly different approach.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set a list of function calls</span></span>
<span><span class="va">list_of_funs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  n <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  av_wage <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">wage</span><span class="op">)</span>,</span>
<span>  weighted_av_wage <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/weighted.mean.html" class="external-link">weighted.mean</a></span><span class="op">(</span><span class="va">wage</span>, <span class="va">sample_weights</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Set the grouping variables</span></span>
<span><span class="va">vars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gender"</span>, <span class="st">"education"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># And create the data cube with dcc6</span></span>
<span><span class="va">invented_wages</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="reference/dcc6.html">dcc6</a></span><span class="op">(</span>.variables <span class="op">=</span> <span class="va">vars</span>, .funs_list <span class="op">=</span> <span class="va">list_of_funs</span>, .total <span class="op">=</span> <span class="st">"TOTAL"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |===================================                                   |  50%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; # A tibble: 12 × 5</span></span>
<span><span class="co">#&gt;    gender education     n av_wage weighted_av_wage</span></span>
<span><span class="co">#&gt;  * &lt;fct&gt;  &lt;fct&gt;     &lt;int&gt;   &lt;dbl&gt;            &lt;dbl&gt;</span></span>
<span><span class="co">#&gt;  1 TOTAL  TOTAL      1000   4985.            4645.</span></span>
<span><span class="co">#&gt;  2 TOTAL  I           172   3774.            3527.</span></span>
<span><span class="co">#&gt;  3 TOTAL  II          719   5099.            4917.</span></span>
<span><span class="co">#&gt;  4 TOTAL  III         109   6139.            5885.</span></span>
<span><span class="co">#&gt;  5 men    TOTAL       547   5435.            5323.</span></span>
<span><span class="co">#&gt;  6 men    I            60   4627.            4681.</span></span>
<span><span class="co">#&gt;  7 men    II          409   5278.            5129.</span></span>
<span><span class="co">#&gt;  8 men    III          78   6886.            6173.</span></span>
<span><span class="co">#&gt;  9 women  TOTAL       453   4441.            3614.</span></span>
<span><span class="co">#&gt; 10 women  I           112   3317.            3227.</span></span>
<span><span class="co">#&gt; 11 women  II          310   4865.            4225.</span></span>
<span><span class="co">#&gt; 12 women  III          31   4261.            4388.</span></span></code></pre></div>
<p>Compared to the results obtained with <code>dcc5</code>, we added the weighted average of wages and changed the <code>"Totale"</code> value to <code>"TOTAL"</code>.</p>
</div>
</div>

  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=distrr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/gibonet/distrr/" class="external-link">Browse source code</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-2" class="external-link">GPL-2</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing distrr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Sandro Burri <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=distrr" class="external-link"><img src="https://www.r-pkg.org/badges/version/distrr" alt="CRAN status"></a></li>
<li><a href="https://github.com/gibonet/distrr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/gibonet/distrr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sandro Burri.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
